<div>
  <h2>Groupes</h2>
  <div id="groupsContainer"></div>
  <input type="text" id="newGroupName" placeholder="Nom du groupe" style="width:70%; padding:10px;">
  <button id="createGroupBtn" style="padding:10px;">Créer un groupe</button>
</div>

<script>
const groupsContainer = document.getElementById("groupsContainer");
const newGroupName = document.getElementById("newGroupName");
const createGroupBtn = document.getElementById("createGroupBtn");
const currentUser = firebase.auth().currentUser.uid;

// Afficher les groupes existants
firebase.firestore().collection("groups").where("members", "array-contains", currentUser).get()
  .then(snapshot => {
    groupsContainer.innerHTML = '';
    snapshot.forEach(doc => {
      const group = doc.data();
      const div = document.createElement('div');
      div.style.border = "1px solid #ccc";
      div.style.padding = "10px";
      div.style.margin = "5px";
      div.style.borderRadius = "5px";
      div.innerHTML = `
        <strong>${group.name}</strong>
        <button onclick="openGroupChat('${doc.id}')">Ouvrir chat</button>
      `;
      groupsContainer.appendChild(div);
    });
  });

// Créer un nouveau groupe
createGroupBtn.addEventListener("click", () => {
  const name = newGroupName.value.trim();
  if(name === "") return alert("Entrez un nom de groupe !");
  firebase.firestore().collection("groups").add({
    name: name,
    members: [currentUser],
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  }).then(() => {
    alert("Groupe créé !");
    window.location.reload();
  });
});

function openGroupChat(groupId){
  // Rediriger vers chat.html pour le groupe
  window.location.href = `chat.html?id=${groupId}&type=group`;
}
                                                </script>
